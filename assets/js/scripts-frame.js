"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}$(document).on("rex:ready",function(){window.iFrameResizer={onReady:function onReady(){"parentIFrame"in window&&new QuickEditFrame}}});var QuickEditFrame=function(){function a(){_classCallCheck(this,a),this.$form=$("form.rex-yform"),this.$fieldsToIgnore=this.$form.find(".yqe-ignore"),this.$formBtnToolbar=this.$form.find(".btn-toolbar"),this.$cancelButton=null,this.success=!1,this.initFrame(),this.attachSubmitHandler()}return _createClass(a,[{key:"initFrame",value:function initFrame(){parentIFrame.sendMessage(rex.yform_quick_edit_hide_loading),this.$formBtnToolbar.append("<a href=\"#\" class=\"btn btn-danger\" id=\"yqe-cancel\">"+rex.yform_quick_edit_cancel+"</a>"),this.$cancelButton=this.$formBtnToolbar.find("#yqe-cancel"),this.$cancelButton.on("click",function(a){a.preventDefault(),parentIFrame.sendMessage(rex.yform_quick_edit_close)}),this.$fieldsToIgnore.each(function(a,b){var c=$(b),d=c.closest(".form-group");d.length?d.hide():c.hide()})}},{key:"attachSubmitHandler",value:function attachSubmitHandler(){var a=this;this.$form.on("submit",function(b){b.preventDefault(),parentIFrame.sendMessage(rex.yform_quick_edit_show_loading),$.ajax({type:"post",url:a.$form.attr("action"),data:a.$form.serialize(),success:function success(b){var c=$(b),d=c.find("form.rex-yform .has-error"),e=a.$form.find(".alert-danger"),f=c.find("form.rex-yform .alert-danger");d.length?($(".has-error").removeClass("has-error"),d.each(function(b,c){var d=$(c);a.$form.find("#"+d.attr("id")).addClass("has-error")}),e.length?e.replaceWith(f):a.$form.prepend(f),parentIFrame.sendMessage(rex.yform_quick_edit_error),parentIFrame.sendMessage(rex.yform_quick_edit_resize)):a.success=!0},error:function error(a){console.error("YForm QuickEdit","  \u21B4","\n",a)},complete:function complete(){parentIFrame.sendMessage(rex.yform_quick_edit_hide_loading),a.success&&parentIFrame.sendMessage(rex.yform_quick_edit_close)}})})}}]),a}();